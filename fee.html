<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maison des FÃ©es - Forest Academy</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/forest.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      position: relative;
    }
    .full-page-image {
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0;
    }
    .content-overlay {
      position: relative;
      z-index: 10;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 40px;
      box-sizing: border-box;
    }
    .text-content {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px 40px;
      border-radius: 20px;
      max-width: 800px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      text-align: center;
      font-size: 1.2rem;
      line-height: 1.8;
      color: #333;
      min-height: 300px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .navigation-buttons {
      display: flex;
      gap: 20px;
      margin-top: 30px;
    }
    .nav-btn {
      padding: 12px 30px;
      background-color: #2d8a47;
      color: white;
      font-weight: bold;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      transition: 0.2s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .nav-btn:hover:not(:disabled) {
      background-color: #256f39;
      transform: scale(1.05);
    }
    .nav-btn:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.6;
    }
    .hidden {
      display: none;
    }
    .character-name {
      font-size: 1.5rem;
      font-weight: bold;
      color: #2d8a47;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <img src="assets/images/fee-text.png" alt="Maison des FÃ©es" class="full-page-image">
  
  <div class="content-overlay">
    <!-- Partie 1 : Introduction -->
    <div id="part-1" class="text-content">
      <div class="character-name">ğŸ‘‹ LibÃ©ria, la fÃ©e des logiciels libres</div>
      <p>Â« Salut, humain curieux ! Je suis LibÃ©ria, la fÃ©e des logiciels libres !</p>
      <p>Tu connais sÃ»rement des logiciels trÃ¨s connusâ€¦ mais souvent payants, fermÃ©s, et qui gardent leurs secrets bien cachÃ©s.</p>
      <p>Moi, je vais te montrer qu'il existe des logiciels libres, que tout le monde peut utiliser, modifier et partager.</p>
      <p>C'est un peu comme une recette de cuisine qu'on partage au lieu de la garder dans un coffre-fort ğŸ§ ! Â»</p>
    </div>

    <!-- Partie 2 : Pourquoi c'est important -->
    <div id="part-2" class="text-content hidden">
      <div class="character-name">âœ¨ Pourquoi les logiciels libres ?</div>
      <p>Â« Les logiciels libres, c'est important pour plusieurs raisons :</p>
      <ul style="text-align: left; margin: 20px 0;">
        <li>Tu peux les utiliser gratuitement (souvent).</li>
        <li>Tu peux voir comment ils sont faits, et mÃªme les amÃ©liorer.</li>
        <li>La communautÃ© peut corriger des bugs et ajouter des fonctionnalitÃ©s.</li>
        <li>Tu ne dÃ©pends pas d'une seule grosse entreprise.</li>
      </ul>
      <p>PrÃªtÂ·e Ã  rejoindre le monde des fÃ©es du logiciel libre ? On va voir si tu reconnais les bons Ã©quivalents ! Â»</p>
    </div>

    <!-- Mini-cours : Qu'est-ce qu'un logiciel propriÃ©taire -->
    <div id="part-3" class="text-content hidden">
      <div class="character-name">ğŸ“š Qu'est-ce qu'un logiciel propriÃ©taire ?</div>
      <p>Â« Un logiciel propriÃ©taire, c'est un logiciel dont le code est fermÃ©. Tu ne peux pas voir comment il fonctionne, tu dois accepter une licence, et souvent payer pour l'utiliser. Â»</p>
    </div>

    <!-- Mini-cours : Qu'est-ce qu'un logiciel libre -->
    <div id="part-4" class="text-content hidden">
      <div class="character-name">ğŸ“š Qu'est-ce qu'un logiciel libre ?</div>
      <p>Â« Un logiciel libre respecte 4 libertÃ©s : utiliser, Ã©tudier, modifier, partager. Ã‡a ne veut pas forcÃ©ment dire gratuit, mais trÃ¨s souvent c'est le cas. Â»</p>
    </div>

    <!-- Mini-cours : Pourquoi c'est intÃ©ressant -->
    <div id="part-5" class="text-content hidden">
      <div class="character-name">ğŸ“š Pourquoi c'est intÃ©ressant ?</div>
      <p>Â« Avec les logiciels libres, on peut Ã©viter de dÃ©pendre d'une seule entreprise, on peut adapter le logiciel Ã  ses besoins, et on participe Ã  une communautÃ© qui partage au lieu de garder pour soi. Â»</p>
    </div>

    <!-- Mini-cours : Exemples concrets -->
    <div id="part-6" class="text-content hidden">
      <div class="character-name">ğŸ“š Exemples concrets</div>
      <p>Â« Tu connais peut-Ãªtre Word, Photoshop, Zoomâ€¦ Eh bien il existe LibreOffice, GIMP, Jitsi, et plein d'autres amis libres ! Â»</p>
    </div>

    <!-- Partie 7 : Explication du jeu -->
    <div id="part-7" class="text-content hidden">
      <div class="character-name">ğŸ® Le jeu</div>
      <p>Â« Dans le jeu qui arrive, tu verras des logiciels propriÃ©taires (souvent payants) d'un cÃ´tÃ©, et tu devras les associer Ã  leur Ã©quivalent libre.</p>
      <p>Glisse les Ã©tiquettes ou clique sur les bonnes paires pour aider moi et mes amis Ã  libÃ©rer le code ! âœ¨ Â»</p>
    </div>

    <!-- Partie 8 : Le jeu d'association -->
    <div id="part-8" class="text-content hidden" style="max-width: 1000px; min-height: 500px;">
      <div class="character-name">ğŸ® Jeu d'association</div>
      <div id="game-container" style="margin-top: 20px;">
        <p style="margin-bottom: 20px;">Associe chaque logiciel propriÃ©taire Ã  son Ã©quivalent libre :</p>
        <div id="game-area" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; width: 100%;">
          <!-- Les cartes seront gÃ©nÃ©rÃ©es par JavaScript -->
        </div>
        <div id="game-feedback" style="margin-top: 20px; font-weight: bold;"></div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="navigation-buttons">
      <button id="btn-prev" class="nav-btn" onclick="previousPart()" disabled>â† PrÃ©cÃ©dent</button>
      <button id="btn-next" class="nav-btn" onclick="nextPart()">Suivant â†’</button>
      <button id="btn-start-game" class="nav-btn hidden" onclick="startGame()">Commencer le jeu</button>
    </div>
  </div>

  <a href="foret.html" class="btn-explorer" style="position: fixed; bottom: 20px; right: 20px; z-index: 20;">Retour Ã  la forÃªt</a>

  <script>
    let currentPart = 1;
    const totalParts = 8;

    // DonnÃ©es du jeu
    const gamePairs = [
      { "proprietaire": "Microsoft Word", "libre": "LibreOffice Writer" },
      { "proprietaire": "Microsoft Excel", "libre": "LibreOffice Calc" },
      { "proprietaire": "Microsoft PowerPoint", "libre": "LibreOffice Impress" },
      { "proprietaire": "Adobe Photoshop", "libre": "GIMP" },
      { "proprietaire": "Adobe Illustrator", "libre": "Inkscape" },
      { "proprietaire": "Microsoft Windows", "libre": "GNU/Linux (Ubuntuâ€¦)" },
      { "proprietaire": "Zoom", "libre": "Jitsi Meet" },
      { "proprietaire": "Google Drive", "libre": "Nextcloud" }
    ];

    let selectedProprietaire = null;
    let selectedLibre = null;
    let matchedPairs = [];
    let currentGamePairs = [];

    function showPart(partNumber) {
      // Cacher toutes les parties
      for (let i = 1; i <= totalParts; i++) {
        document.getElementById(`part-${i}`).classList.add('hidden');
      }
      
      // Afficher la partie actuelle
      document.getElementById(`part-${currentPart}`).classList.remove('hidden');
      
      // GÃ©rer les boutons
      document.getElementById('btn-prev').disabled = currentPart === 1;
      document.getElementById('btn-next').classList.toggle('hidden', currentPart >= totalParts - 1);
      document.getElementById('btn-start-game').classList.toggle('hidden', currentPart !== totalParts - 1);
      
      // Si on arrive au jeu, l'initialiser
      if (currentPart === totalParts) {
        initGame();
      }
    }

    function nextPart() {
      if (currentPart < totalParts) {
        currentPart++;
        showPart(currentPart);
      }
    }

    function previousPart() {
      if (currentPart > 1) {
        currentPart--;
        showPart(currentPart);
      }
    }

    function startGame() {
      currentPart = totalParts;
      showPart(currentPart);
    }

    function initGame() {
      // SÃ©lectionner 5-8 paires au hasard
      const shuffled = [...gamePairs].sort(() => Math.random() - 0.5);
      currentGamePairs = shuffled.slice(0, Math.min(6, shuffled.length));
      
      // MÃ©langer les logiciels libres avec leur index original
      const libresWithIndex = currentGamePairs.map((p, idx) => ({ text: p.libre, originalIndex: idx }));
      libresWithIndex.sort(() => Math.random() - 0.5);
      const proprietaires = currentGamePairs.map(p => p.proprietaire);
      
      matchedPairs = [];
      selectedProprietaire = null;
      selectedLibre = null;
      
      // Afficher les cartes
      const gameArea = document.getElementById('game-area');
      gameArea.innerHTML = '';
      
      // Colonne gauche : logiciels propriÃ©taires
      const leftCol = document.createElement('div');
      leftCol.style.cssText = `
        display: flex;
        flex-direction: column;
        gap: 15px;
        flex: 1;
        min-width: 0;
      `;
      proprietaires.forEach((prop, index) => {
        const card = createCard(prop, 'proprietaire', index);
        leftCol.appendChild(card);
      });
      
      // Colonne droite : logiciels libres
      const rightCol = document.createElement('div');
      rightCol.style.cssText = `
        display: flex;
        flex-direction: column;
        gap: 15px;
        flex: 1;
        min-width: 0;
      `;
      libresWithIndex.forEach((item, displayIndex) => {
        const card = createCard(item.text, 'libre', item.originalIndex);
        card.dataset.displayIndex = displayIndex; // Index d'affichage pour rÃ©fÃ©rence
        rightCol.appendChild(card);
      });
      
      gameArea.appendChild(leftCol);
      gameArea.appendChild(rightCol);
      
      document.getElementById('game-feedback').textContent = '';
    }

    function createCard(text, type, index) {
      const card = document.createElement('div');
      card.className = 'game-card';
      card.textContent = text;
      card.dataset.index = index;
      card.dataset.type = type;
      // Calculer la taille de police adaptative basÃ©e sur la longueur du texte
      const textLength = text.length;
      let fontSize = '0.9rem';
      if (textLength > 30) {
        fontSize = '0.75rem';
      } else if (textLength > 20) {
        fontSize = '0.85rem';
      }
      
      // Couleur initiale
      let bgColor = matchedPairs.includes(index) ? '#90EE90' : '#fff';
      let borderColor = '#ddd';
      if (selectedProprietaire === index && type === 'proprietaire') {
        borderColor = '#2d8a47';
      } else if (selectedLibre === index && type === 'libre') {
        borderColor = '#2d8a47';
      }
      
      card.style.cssText = `
        padding: 12px 10px;
        background: ${bgColor};
        border: 3px solid ${borderColor};
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        word-wrap: break-word;
        overflow-wrap: break-word;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 60px;
        max-height: 100px;
        max-width: 100%;
        width: 100%;
        box-sizing: border-box;
        font-size: ${fontSize};
        line-height: 1.2;
      `;
      
      card.onclick = () => selectCard(index, type);
      card.onmouseenter = () => {
        if (!matchedPairs.includes(index)) {
          card.style.transform = 'scale(1.05)';
          card.style.boxShadow = '0 6px 12px rgba(0,0,0,0.2)';
        }
      };
      card.onmouseleave = () => {
        if (!matchedPairs.includes(index)) {
          card.style.transform = 'scale(1)';
          card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
        }
      };
      
      return card;
    }

    function selectCard(index, type) {
      if (matchedPairs.includes(index)) return;
      
      // Si on clique sur une carte dÃ©jÃ  sÃ©lectionnÃ©e, on la dÃ©sÃ©lectionne
      if (type === 'proprietaire' && selectedProprietaire === index) {
        selectedProprietaire = null;
        refreshCards();
        return;
      }
      if (type === 'libre' && selectedLibre === index) {
        selectedLibre = null;
        refreshCards();
        return;
      }
      
      // SÃ©lectionner la carte
      if (type === 'proprietaire') {
        selectedProprietaire = index;
        selectedLibre = null; // RÃ©initialiser la sÃ©lection libre si on change de propriÃ©taire
      } else {
        selectedLibre = index;
      }
      
      refreshCards();
      
      // VÃ©rifier si on a une paire complÃ¨te
      if (selectedProprietaire !== null && selectedLibre !== null) {
        // selectedLibre est maintenant l'index original dans currentGamePairs
        const propText = currentGamePairs[selectedProprietaire].proprietaire;
        const libreText = currentGamePairs[selectedLibre].libre;
        const pair = currentGamePairs.find(p => p.proprietaire === propText && p.libre === libreText);
        
        if (pair) {
          // Bonne association : les deux cartes deviennent vertes et restent vertes
          matchedPairs.push(selectedProprietaire, selectedLibre);
          document.getElementById('game-feedback').textContent = 'âœ… Bonne association !';
          document.getElementById('game-feedback').style.color = '#2d8a47';
          selectedProprietaire = null;
          selectedLibre = null;
          refreshCards();
          
          // VÃ©rifier si le jeu est terminÃ©
          if (matchedPairs.length === currentGamePairs.length * 2) {
            setTimeout(() => {
              document.getElementById('game-feedback').textContent = 'ğŸ‰ FÃ©licitations ! Tu as terminÃ© le jeu !';
              document.getElementById('game-feedback').style.color = '#2d8a47';
            }, 500);
          }
        } else {
          // Mauvaise association : les deux cartes deviennent rouges pendant 3 secondes
          document.getElementById('game-feedback').textContent = 'âŒ Ce n\'est pas la bonne association. RÃ©essaye !';
          document.getElementById('game-feedback').style.color = '#d32f2f';
          
          // Marquer temporairement les cartes comme incorrectes (avec leurs types)
          const tempWrong = [
            { index: selectedProprietaire, type: 'proprietaire' },
            { index: selectedLibre, type: 'libre' }
          ];
          refreshCards(true, tempWrong);
          
          setTimeout(() => {
            selectedProprietaire = null;
            selectedLibre = null;
            document.getElementById('game-feedback').textContent = '';
            refreshCards();
          }, 3000);
        }
      }
    }
    
    function refreshCards(isWrong = false, wrongCards = []) {
      const gameArea = document.getElementById('game-area');
      const cards = gameArea.querySelectorAll('.game-card');
      
      cards.forEach((card) => {
        const index = parseInt(card.dataset.index);
        const type = card.dataset.type;
        
        let bgColor = '#fff';
        let borderColor = '#ddd';
        
        // Si c'est une mauvaise association, vÃ©rifier si cette carte correspond
        let isWrongCard = false;
        if (isWrong && wrongCards.length > 0) {
          isWrongCard = wrongCards.some(wc => wc.index === index && wc.type === type);
        }
        
        if (isWrongCard) {
          bgColor = '#ffcccc'; // Rouge pour les mauvaises associations temporaires
          borderColor = '#d32f2f';
        } else if (matchedPairs.includes(index)) {
          bgColor = '#90EE90'; // Vert pour les bonnes associations
          borderColor = '#2d8a47';
        } else if (selectedProprietaire === index && type === 'proprietaire') {
          borderColor = '#2d8a47';
        } else if (selectedLibre === index && type === 'libre') {
          borderColor = '#2d8a47';
        }
        
        card.style.background = bgColor;
        card.style.borderColor = borderColor;
      });
    }

    // Initialisation
    showPart(1);
  </script>
</body>
</html>
